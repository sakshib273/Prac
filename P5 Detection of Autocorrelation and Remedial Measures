write.csv(data, "sales_data.csv", row.names = FALSE)
data <- read.csv("sales_data.csv")

model <- lm(sales ~ advertising, data = data)
summary(model)

install.packages("lmtest")  # Run once
library(lmtest)

dwtest(model)

plot(residuals(model), type = "o", main="Residuals Plot")

acf(residuals(model))

data$sales_lag1 <- c(NA, data$sales[-length(data$sales)])
model_lag <- lm(sales ~ advertising + sales_lag1, data = data[-1, ])
summary(model_lag)
dwtest(model_lag)

install.packages("orcutt")  # Run once
library(orcutt)

model_co <- cochrane.orcutt(model)
summary(model_co)
dwtest(model_co)

install.packages("nlme")
library(nlme)

model_gls <- gls(sales ~ advertising, correlation = corAR1(form = ~ month), data = data)
summary(model_gls)


